# 新入社員向け研修招待の自動化システム 要件定義書

## 1. プロジェクト概要

### 1.1. プロジェクト名
新入社員向け研修招待の自動化システム

### 1.2. バージョン
1.0

### 1.3. 背景と目的
現在、毎月1日と15日に入社する新入社員（毎月約15名）への研修案内とカレンダー招待は、人事担当者がすべて手動で行っている。このプロセスは定型的ながら工数が大きく、ヒューマンエラー（招待漏れ、日時間違いなど）のリスクを伴う。
本プロジェクトでは、GoogleスプレッドシートとGoogleカレンダー、Google Apps Scriptを連携させ、この招待プロセスを自動化する。これにより、人事担当者の業務効率を大幅に向上させ、招待プロセスの正確性と信頼性を確保することを目的とする。

## 2. 関係者 (Stakeholders)

| 役割 | 責務 |
| :--- | :--- |
| **人事担当者** | ・システムの主な利用者。<br>・新入社員の情報をスプレッドシートに入力する。<br>・招待が正しく送信されたかを確認する。 |
| **システム管理者** | ・Google Apps Scriptの開発および保守を行う。<br>・研修体系の変更やシステムトラブルに対応する。 |

## 3. ユースケース (Use Cases)

| ID | ユースケース名 | アクター | 概要 |
| :--- | :--- | :--- | :--- |
| UC-01 | 新入社員情報の登録 | 人事担当者 | 新しい入社者が決まった際、指定のスプレッドシートに「入社日」「氏名」「メールアドレス」を追記する。 |
| UC-02 | 研修招待の自動送信 | システム | 毎月1日・15日の指定時刻に自動起動し、その日に入社する全対象者に対し、定義済みの全研修招待を一括送信する。 |
| UC-03 | 研修内容のメンテナンス | 人事担当者 or<br>システム管理者 | 研修の時間や内容が変更された場合、「研修マスター」シートを更新する。この変更は以降の招待に自動反映される。|

## 4. 機能要件 (Functional Requirements)

### FR-01: データ管理機能
-   入社者のリスト（入社日, 氏名, メールアドレス, 処理状況）を管理するスプレッドシート（以下、`入社者リスト`）を持つこと。
-   招待すべき研修のテンプレート情報（研修名, 入社後日数, 開始時刻, 所要時間, 説明）を管理するスプレッドシート（以下、`研修マスター`）を持つこと。
-   誰にどの研修をいつ送信したかの履歴を記録するためのスプレッドシート（以下、`招待ログ`）を持つこと。

### FR-02: 招待イベント作成機能
-   `入社者リスト`と`研修マスター`の情報を組み合わせ、正しい日時・内容でカレンダーイベントを生成できること。
-   `研修マスター`には、入社日を基準とした相対的な日程（例：入社日の翌日 = `1`）を設定できること。
-   イベントの説明（メモ）欄に、`研修マスター`で指定した詳細情報（持ち物、事前課題など）を記載できること。

### FR-03: 招待メール送信機能
-   生成したカレンダーイベントの招待状を、対象者のメールアドレスに自動で送信できること。
-   招待は、事前に指定されたGoogleカレンダーアカウントから送信されること。

### FR-04: 処理ステータス管理機能
-   招待処理が完了した入社者の`入社者リスト`上のステータスを「招待済み」に更新すること。
-   処理に失敗した場合、エラー内容をステータスに記録し、後から原因を追跡できるようにすること。
-   **二重招待防止**: `招待ログ`を参照し、既に招待済みの研修はスキップするロジックを持つこと。

## 5. 非機能要件 (Non-functional Requirements)

### NFR-01: 自動実行（可用性）
-   システムは、人手を介さず毎月1日と15日の指定された時間帯に自動で実行されること。（Google Apps Scriptのトリガー機能で実現）

### NFR-02: 運用・保守性
-   研修内容や対象者の追加・変更は、原則としてコードを修正することなく、スプレッドシート上のデータ編集のみで完結すること。
-   エラー発生時には、`招待ログ`や`入社者リスト`のステータスから原因を特定しやすい設計であること。

### NFR-03: セキュリティ
-   スクリプトの実行には、適切なGoogleアカウントの権限承認（スプレッドシートの読み書き、カレンダーの管理権限）を必要とすること。

### NFR-04: 拡張性
-   将来的に研修の種類が増減した場合でも、`研修マスター`シートの行を追加・削除するだけで柔軟に対応可能であること。
